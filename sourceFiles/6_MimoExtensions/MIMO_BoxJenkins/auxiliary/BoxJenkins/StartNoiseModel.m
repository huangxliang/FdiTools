% starting values poles noise modelIndex1 = [2:1:N/2].';					% no DC nor Nyquistfreq1 = (Index1-1)/N/Ts;switch ThePlantPlane	case 's', s1 = 2*pi*sqrt(-1)*freq1;	case 'w', s1 = (2*pi*sqrt(-1)*freq1).^(0.5);	case 'z', s1 = exp(-sqrt(-1)*2*pi*freq1*Ts);endswitch TheNoisePlane	case 's', q1 = 2*pi*sqrt(-1)*freq1;	case 'w', q1 = (2*pi*sqrt(-1)*freq1).^(0.5);	case 'z', q1 = exp(-sqrt(-1)*2*pi*freq1*Ts);endV1 = zeros(1,N).';G1 = polyval(fliplr(bs),s1)./polyval(fliplr(as),s1);TG1 = polyval(fliplr(igs),s1)./polyval(fliplr(as),s1);V1(Index1) = Y1(Index1) - G1.*U1(Index1) - TG1;v1 = 2*real(ifft(V1));Rv1 = xcorr(v1,v1,'unbiased');Rv1 = xcorr(v1,v1);figure(3)subplot(321)plot(freq1,db(V1(Index1)))subplot(323)plot(Rv1)subplot(324)plot(Rv1(N:end))zoom on;shgNRv1 = length(Rv1);Select = [N:N+300];Select = [N:NRv1];Nsel = length(Select);freqSel = [1:Nsel/2-1].'/Nsel/Ts;InBand = find((freqSel>=freq(1)) & (freqSel<=freq(end)));VV1 = fft(Rv1(Select));VV1 = VV1([1:Nsel/2-1]);VV1 = VV1(InBand);freqSel = freqSel(InBand);switch TheNoisePlane	case 's', qSel = 2*pi*sqrt(-1)*freqSel;	case 'w', qSel = (2*pi*sqrt(-1)*freqSel).^(0.5);	case 'z', qSel = exp(-sqrt(-1)*2*pi*freqSel*Ts);endSelC = ones(1,OrderD+1);SelD = ones(1,OrderD+1);UU = (randn(size(VV1))+sqrt(-1)*randn(size(VV1)))/sqrt(2);YY = VV1.*UU;[ds, cs, jhs, varY] = StartBoxJenkins(YY, UU, freqSel, Ts, SelD, SelC, OrderJ, ThePlane{2}, ClosedLoop, LevenbergMarquardt,...										MaxItterations, TolParam, TolCost, TraceOn);Hs = polyval(fliplr(cs),qSel)./polyval(fliplr(ds),qSel);subplot(322)plot(freqSel,db(varY)/2)subplot(325)plot(freqSel,db(VV1),freqSel,db(Hs),'k')subplot(326)plot(freqSel,angle(VV1)*180/pi,freqSel,angle(Hs)*180/pi,'k')roots(fliplr(ds))roots(fliplr(d0))